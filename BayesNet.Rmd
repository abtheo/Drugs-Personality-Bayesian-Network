---
title: "Drug Consumption & Personality Types"
output: html_notebook
---
<hr/>
Bayesian statistics, armchair psychology, and a whole load of drugs. Move over Sigmund Freud.


<h2>Dataset Description</h2>
<hr/>
The dataset contains records for 1885 respondents. For each respondent 12 attributes are known: Personality measurements which include NEO-FFI-R (neuroticism, extraversion, openness to experience, agreeableness, and conscientiousness), BIS-11 (impulsivity), and ImpSS (sensation seeking), level of education, age, gender, country of residence and ethnicity. All input attributes are originally categorical and are quantified. After quantification values of all input features can be considered as real-valued. In addition, participants were questioned concerning their use of 18 legal and illegal drugs (alcohol, amphetamines, amyl nitrite, benzodiazepine, cannabis, chocolate, cocaine, caffeine, crack, ecstasy, heroin, ketamine, legal highs, LSD, methadone, mushrooms, nicotine and volatile substance abuse and one fictitious drug (Semeron) which was introduced to identify over-claimers. For each drug they have to select one of the answers: never used the drug, used it over a decade ago, or in the last decade, year, month, week, or day.
Database contains 18 classification problems. Each of independent label variables contains seven classes: "Never Used", "Used over a Decade Ago", "Used in Last Decade", "Used in Last Year", "Used in Last Month", "Used in Last Week", and "Used in Last Day".


Detailed description of database and process of data quantification are presented in E. Fehrman, A. K. Muhammad, E. M. Mirkes, V. Egan and A. N. Gorban, "The Five Factor Model of personality and evaluation of drug consumption risk.," arXiv, 2015.



<i>Dataset available at: http://archive.ics.uci.edu/ml/datasets/Drug+consumption+%28quantified%29#</i>

```{r Dependencies, message=FALSE, warning=FALSE, include=FALSE}
library(tools)
install.packages("remotes")
remotes::install_github("jtextor/bayesianNetworks")
library( bayesianNetworks )

install.packages("bnlearn")
library( bnlearn )
library(readr)
install.packages("tidyr")
install.packages("dplyr")
library(dplyr)
library(tidyr)


install.packages('dagitty')
library(dagitty)
install.packages('ggplot2')
library(ggplot2)
install.packages("ggridges")
library(ggridges)

install.packages('Hmisc')
library(Hmisc)
```

<h2>Import Dataset</h2>
<hr/>
```{r message=FALSE}
# Import the data and look at the first six rows
df <- read_csv("drug_consumption.csv")
df$ID <- NULL
#,col_types=paste("i", strrep("f",31),sep="")
head(df)
```
<h1>Exploratory Data Analysis</h1>
<hr/>
First off, let's get to know our dataset a little better. Of particular importance when working with Bayesian statistics is to investigate the number of classes per feature. Each class increases the number of model parameters, but moreover, we must ensure a sufficient number of samples are available in each case. When we lack samples, as often with the Personality Trait features, we can mitigate group classes up to a higher aggregation level.

<h2>Frequency Table</h2>  
Quick example, print the number of occurrences of each class for a couple of the features. Obviously the more classes a feature has, the fewer occurrences there will be per class, roughly following a Gaussian distribution.
```{r}
sapply(df[c("Gender","Age", "Openness")], ftable)
```
<h2>Histogram</h2>
For the more visually inclined, the same information can be better presented by plotting histograms of each feature.

```{r}
#Found a prettier one!
#hist.data.frame(df, color="darkmagenta")


par(mfrow = c(2, 3), mar = c(4, 2, 2, 2))
for (var in colnames(df)) {

   x = as.numeric(unlist(df[, var]))
   hist(x, prob = TRUE, xlab = var, ylab = "", main = "", col = "ivory")
   lines(density(x, bw=0.5), lwd = 2, col = "tomato")
   curve(dnorm(x, mean = mean(x), sd = sd(x)), from = min(x), to = max(x),
     add = TRUE, lwd = 2, col = "steelblue")
}
```


<h2>Kernel Density Estimation</h2>
We can plot an estimated probability density function by fitting a Gaussian kernel to each observation. Using ggridges package for a nice way to glance over the distribution of many feature combinations at a time.
```{r}
df %>% 
  ggplot(aes(Impulsiveness, as.factor(Alcohol))) +
  geom_density_ridges(alpha = 0.5, bandwidth = 0.18, fill = "red") +
  labs(y="Alcohol Use", title = "Alcohol Use vs. Impulsiveness")  +
  theme_ridges(center_axis_labels=TRUE, grid=FALSE)

df %>% 
  ggplot(aes(Openness, as.factor(Cannabis))) +
  geom_density_ridges(alpha = 0.5, bandwidth = 0.18, fill = "green") +
  labs(y = "Cannabis Use", title = "Cannabis Use vs. Openness")  +
  theme_ridges(center_axis_labels=TRUE, grid=FALSE)

```


<h1>Fitting Models from Data</h1>
The connections present in a Bayesian Network drawn from the dataset can lend insights into the   relationships between variables. Note that taking different subsets of features will result in starkly different graphs, often causing relationships between specific nodes to invert or disappear. This limits the investigative usefulness of such a model, however we believe it still holds some informative value. To mitigate these problems, we split our features into rigid semantic groups in the section below.

We will ultimately define a custom network configuration, and encode causal direction according to our own logical determinations about the reality of the situation, rather than naively trusting our data.

```{r}
df <- read_csv("drug_consumption.csv")
#Take a subset of the data for a smaller example network
cols <- c("Age","Ecstacy", "Extraversion")
data <- df[cols]
data[cols] <- lapply(df[cols], factor)
#Aggregate personality value levels

#data$Extraversion <- cut(df$Extraversion, breaks=4, labels=seq_len(4))

#Split train-test
#smp_size <- floor(0.75 * nrow(data))
#train_ind <- sample(seq_len(nrow(data)), size = smp_size)

#train_data <- data[train_ind, ]
#test_data <- data[-train_ind, ]

#Fit network on data subset
fit <-pc.stable(df[cols])
plot(fit)
fit

#
ci.test(x=data$Age, y=data$Ecstacy, z=data$Extraversion, test="x2")

```
<h2>Semantic Segregation</h2>
There are three clearly distinct categories of feature found within our dataset:

  <ul>
    <li>
      Facts: we wish to condition our model on these variables. We know there is no causal relationship between the  other two categories which will influence these variables. Conversely, they will likely have an influence on the majority of variables from the other two categories, so adjusting for them will be necessary.
    </li>
    <li>
      Personalities: 
    </li>
    <li>
      Drugs:
    </li>
  </ul>


<h3>Facts</h3>
```{r}
facts = c("Age",
           "Gender",
           "Country",
           "Ethnicity",
           "Education")

fit <-pc.stable(df[facts])
plot(fit)
```
These results seem sensible. Age, Gender & Ethnicity all have no parent nodes as we'd hope.

However, there do seem to be extraneous relationships being drawn; in particular, Country counter-intuitively appears to be the child of every other node.

Let's test it out.
```{r}
chisq <- 0 ; out <- 0
for( x in unique(df$Age) )
{
  tst <-chisq.test( df$Education[df$Age==x], df$Country[df$Age==x] )
  chisq <- chisq+tst$statistic
  out <- out + tst$parameter
}
chisq
out
1 - pchisq(chisq, out)
```

```{r}
impliedConditionalIndependencies(fit)
#dagitty::localTests(fit, df[drugs], type="cis.chisq")
```

<h3>Personalities</h3>
```{r warning=FALSE}
personalities = c("Extraversion", 
                  "Neuroticism", 
                  "Openness",
                  "Agreeableness",
                  "Conscientiousness",
                  "Impulsiveness",
                  "SensationSeeking")


fit <-pc.stable(df[personalities])
plot(fit)
```

<h3>Drugs</h3>
```{r warning=FALSE}
drugs = c("Alcohol",
          "Amphetamines",
          "AmylNitrate",
          "Benzos",
          "Caffeine",
          "Cannabis",
          "Chocolate",
          "Cocaine",
          "Crack",
          "Ecstacy",
          "Heroin",
          "Ketamine",
          "LegalHighs",
          "LSD",
          "Meth",
          "Mushrooms",
          "Nicotine",
          "Semeron", 
          "VSA")

fit <-pc.stable(df[drugs])
plot
fit
```
Wow, that's a fair few connections! Let's reduce the number of levels and see how that influences the network structure. We will try reducing to a binary class of 'User' vs. 'Non-user', with the cut-off being that you must have used a given drug within the last year.
```{r}
reduce_drug_levels <- function(drug_col)
{
  return(ifelse(drug_col < 3, 0, 1))
}
drugs_user_levels <- as.data.frame(apply(X=df[drugs], MARGIN=2, FUN=reduce_drug_levels))

fit <-pc.stable(drugs_user_levels)
plot(fit)

fit
```


<h1>Bayesian Network</h1>
```{r}
testImplications <- function( covariance.matrix, sample.size ){
	library(ggm)
	tst <- function(i){ pcor.test( pcor(i,covariance.matrix), length(i)-2, sample.size )$pvalue }
tos <- function(i){ paste(i,collapse=" ") }
implications <- list(c("Age","Alcohol","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking","Agreeableness"),
		c("Age","Amphetamines","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","AmylNitrate","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","Benzos","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","Caffeine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","Cannabis","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","Chocolate","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","Cocaine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","Country"),
		c("Age","Crack","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","Ecstacy","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","Ethnicity"),
		c("Age","Gender"),
		c("Age","Heroin","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Age","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","Amphetamines","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","AmylNitrate","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","Benzos","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","Caffeine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","Cannabis","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","Chocolate","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","Cocaine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","Country","Agreeableness","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness"),
		c("Alcohol","Crack","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","Ecstacy","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","Education","Agreeableness","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness"),
		c("Alcohol","Ethnicity","Agreeableness","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness"),
		c("Alcohol","Gender","Agreeableness","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness"),
		c("Alcohol","Heroin","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Alcohol","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","AmylNitrate","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","Benzos","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","Caffeine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","Cannabis","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","Chocolate","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","Cocaine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","Country","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Amphetamines","Crack","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","Ecstacy","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","Education","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Amphetamines","Ethnicity","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Amphetamines","Gender","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Amphetamines","Heroin","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Amphetamines","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","Benzos","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","Caffeine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","Cannabis","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","Chocolate","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","Cocaine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","Country","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("AmylNitrate","Crack","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","Ecstacy","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","Education","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("AmylNitrate","Ethnicity","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("AmylNitrate","Gender","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("AmylNitrate","Heroin","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("AmylNitrate","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Benzos","Caffeine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Benzos","Cannabis","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Benzos","Chocolate","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Benzos","Cocaine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Benzos","Country","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Benzos","Crack","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Benzos","Ecstacy","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Benzos","Education","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Benzos","Ethnicity","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Benzos","Gender","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Benzos","Heroin","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Benzos","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Benzos","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Benzos","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Benzos","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Benzos","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Benzos","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Benzos","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Benzos","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Caffeine","Cannabis","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Caffeine","Chocolate","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Caffeine","Cocaine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Caffeine","Country","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Caffeine","Crack","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Caffeine","Ecstacy","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Caffeine","Education","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Caffeine","Ethnicity","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Caffeine","Gender","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Caffeine","Heroin","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Caffeine","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Caffeine","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Caffeine","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Caffeine","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Caffeine","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Caffeine","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Caffeine","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Caffeine","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cannabis","Chocolate","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cannabis","Cocaine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cannabis","Country","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Cannabis","Crack","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cannabis","Ecstacy","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cannabis","Education","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Cannabis","Ethnicity","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Cannabis","Gender","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Cannabis","Heroin","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cannabis","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cannabis","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cannabis","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cannabis","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cannabis","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cannabis","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cannabis","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cannabis","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Chocolate","Cocaine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Chocolate","Country","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Chocolate","Crack","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Chocolate","Ecstacy","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Chocolate","Education","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Chocolate","Ethnicity","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Chocolate","Gender","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Chocolate","Heroin","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Chocolate","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Chocolate","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Chocolate","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Chocolate","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Chocolate","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Chocolate","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Chocolate","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Chocolate","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cocaine","Country","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Cocaine","Crack","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cocaine","Ecstacy","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cocaine","Education","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Cocaine","Ethnicity","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Cocaine","Gender","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Cocaine","Heroin","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cocaine","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cocaine","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cocaine","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cocaine","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cocaine","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cocaine","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cocaine","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Cocaine","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Country","Crack","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Country","Ecstacy","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Country","Gender"),
		c("Country","Heroin","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Country","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Country","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Country","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Country","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Country","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Country","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Country","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Country","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Crack","Ecstacy","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Crack","Education","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Crack","Ethnicity","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Crack","Gender","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Crack","Heroin","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Crack","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Crack","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Crack","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Crack","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Crack","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Crack","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Crack","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Crack","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ecstacy","Education","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Ecstacy","Ethnicity","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Ecstacy","Gender","SensationSeeking","Openness","Neuroticism","Impulsiveness","Extraversion","Conscientiousness","Agreeableness"),
		c("Ecstacy","Heroin","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ecstacy","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ecstacy","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ecstacy","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ecstacy","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ecstacy","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ecstacy","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ecstacy","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ecstacy","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Education","Ethnicity","Country"),
		c("Education","Gender"),
		c("Education","Heroin","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Education","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Education","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Education","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Education","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Education","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Education","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Education","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Education","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ethnicity","Gender"),
		c("Ethnicity","Heroin","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ethnicity","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ethnicity","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ethnicity","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ethnicity","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ethnicity","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ethnicity","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ethnicity","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ethnicity","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Gender","Heroin","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Gender","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Gender","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Gender","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Gender","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Gender","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Gender","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Gender","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Gender","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Heroin","Ketamine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Heroin","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Heroin","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Heroin","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Heroin","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Heroin","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Heroin","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Heroin","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ketamine","LSD","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ketamine","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ketamine","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ketamine","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ketamine","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ketamine","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Ketamine","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("LSD","LegalHighs","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("LSD","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("LSD","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("LSD","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("LSD","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("LSD","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("LegalHighs","Meth","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("LegalHighs","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("LegalHighs","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("LegalHighs","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("LegalHighs","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Meth","Mushrooms","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Meth","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Meth","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Meth","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Mushrooms","Nicotine","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Mushrooms","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Mushrooms","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Nicotine","Semeron","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Nicotine","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"),
		c("Semeron","VSA","Agreeableness","Conscientiousness","Extraversion","Impulsiveness","Neuroticism","Openness","SensationSeeking"))
	data.frame( implication=unlist(lapply(implications,tos)),
		pvalue=unlist( lapply( implications, tst ) ) )

}
```

```{r}
cov_df <- df
cov_df$ID <- NULL
cov_matrix = cov(cov_df, cov_df)

col<- colorRampPalette(c("blue", "white", "red"))(20)
heatmap(cov_matrix, col=col, symm=TRUE)
```

```{r}
implied <- testImplications(cov_matrix, length(cov_df))
#[implied$pvalue > alpha,]
implied[rev(order(implied$pvalue)),]
```

```{r}

graph <- dagitty('
dag {
bb="0,0,1,1"
Age [adjusted,pos="0.194,0.095"]
Agreeableness [exposure,pos="0.265,0.362"]
Alcohol [outcome,pos="0.141,0.720"]
Amphetamines [outcome,pos="0.089,0.665"]
AmylNitrate [outcome,pos="0.669,0.667"]
Background [latent,pos="0.323,0.199"]
Benzos [outcome,pos="0.187,0.661"]
Caffeine [outcome,pos="0.228,0.721"]
Cannabis [outcome,pos="0.267,0.656"]
Chocolate [outcome,pos="0.570,0.700"]
Cocaine [outcome,pos="0.596,0.622"]
Conscientiousness [exposure,pos="0.432,0.353"]
Country [adjusted,pos="0.313,0.078"]
Crack [outcome,pos="0.797,0.609"]
Ecstacy [outcome,pos="0.400,0.703"]
Education [adjusted,pos="0.262,0.093"]
Ethnicity [adjusted,pos="0.379,0.078"]
Extraversion [exposure,pos="0.759,0.346"]
Gender [adjusted,pos="0.436,0.128"]
Heroin [outcome,pos="0.315,0.710"]
Impulsiveness [exposure,pos="0.682,0.348"]
Ketamine [outcome,pos="0.487,0.687"]
LSD [outcome,pos="0.761,0.668"]
LegalHighs [outcome,pos="0.517,0.621"]
Meth [outcome,pos="0.847,0.674"]
Mushrooms [outcome,pos="0.882,0.607"]
Neuroticism [exposure,pos="0.346,0.363"]
Nicotine [outcome,pos="0.710,0.618"]
Openness [exposure,pos="0.514,0.356"]
Semeron [outcome,pos="0.439,0.638"]
SensationSeeking [exposure,pos="0.594,0.354"]
VSA [outcome,pos="0.357,0.653"]
Age -> Background
Age -> Education
Agreeableness -> Alcohol
Agreeableness -> Amphetamines
Agreeableness -> AmylNitrate
Agreeableness -> Benzos
Agreeableness -> Caffeine
Agreeableness -> Cannabis
Agreeableness -> Chocolate
Agreeableness -> Cocaine
Agreeableness -> Crack
Agreeableness -> Ecstacy
Agreeableness -> Heroin
Agreeableness -> Ketamine
Agreeableness -> LSD
Agreeableness -> LegalHighs
Agreeableness -> Meth
Agreeableness -> Mushrooms
Agreeableness -> Nicotine
Agreeableness -> Semeron
Agreeableness -> VSA
Background -> Agreeableness
Background -> Conscientiousness
Background -> Extraversion
Background -> Impulsiveness
Background -> Neuroticism
Background -> Openness
Background -> SensationSeeking
Conscientiousness -> Alcohol
Conscientiousness -> Amphetamines
Conscientiousness -> AmylNitrate
Conscientiousness -> Benzos
Conscientiousness -> Caffeine
Conscientiousness -> Cannabis
Conscientiousness -> Chocolate
Conscientiousness -> Cocaine
Conscientiousness -> Crack
Conscientiousness -> Ecstacy
Conscientiousness -> Heroin
Conscientiousness -> Ketamine
Conscientiousness -> LSD
Conscientiousness -> LegalHighs
Conscientiousness -> Meth
Conscientiousness -> Mushrooms
Conscientiousness -> Nicotine
Conscientiousness -> Semeron
Conscientiousness -> VSA
Country -> Background
Country -> Education
Education -> Background
Ethnicity -> Background
Ethnicity -> Country
Extraversion -> Alcohol
Extraversion -> Amphetamines
Extraversion -> AmylNitrate
Extraversion -> Benzos
Extraversion -> Caffeine
Extraversion -> Cannabis
Extraversion -> Chocolate
Extraversion -> Cocaine
Extraversion -> Crack
Extraversion -> Ecstacy
Extraversion -> Heroin
Extraversion -> Ketamine
Extraversion -> LSD
Extraversion -> LegalHighs
Extraversion -> Meth
Extraversion -> Mushrooms
Extraversion -> Nicotine
Extraversion -> Semeron
Extraversion -> VSA
Gender -> Background
Impulsiveness -> Alcohol
Impulsiveness -> Amphetamines
Impulsiveness -> AmylNitrate
Impulsiveness -> Benzos
Impulsiveness -> Caffeine
Impulsiveness -> Cannabis
Impulsiveness -> Chocolate
Impulsiveness -> Cocaine
Impulsiveness -> Crack
Impulsiveness -> Ecstacy
Impulsiveness -> Heroin
Impulsiveness -> Ketamine
Impulsiveness -> LSD
Impulsiveness -> LegalHighs
Impulsiveness -> Meth
Impulsiveness -> Mushrooms
Impulsiveness -> Nicotine
Impulsiveness -> Semeron
Impulsiveness -> VSA
Neuroticism -> Alcohol
Neuroticism -> Amphetamines
Neuroticism -> AmylNitrate
Neuroticism -> Benzos
Neuroticism -> Caffeine
Neuroticism -> Cannabis
Neuroticism -> Chocolate
Neuroticism -> Cocaine
Neuroticism -> Crack
Neuroticism -> Ecstacy
Neuroticism -> Heroin
Neuroticism -> Ketamine
Neuroticism -> LSD
Neuroticism -> LegalHighs
Neuroticism -> Meth
Neuroticism -> Mushrooms
Neuroticism -> Nicotine
Neuroticism -> Semeron
Neuroticism -> VSA
Openness -> Alcohol
Openness -> Amphetamines
Openness -> AmylNitrate
Openness -> Benzos
Openness -> Caffeine
Openness -> Cannabis
Openness -> Chocolate
Openness -> Cocaine
Openness -> Crack
Openness -> Ecstacy
Openness -> Heroin
Openness -> Ketamine
Openness -> LSD
Openness -> LegalHighs
Openness -> Meth
Openness -> Mushrooms
Openness -> Nicotine
Openness -> Semeron
Openness -> VSA
SensationSeeking -> Alcohol
SensationSeeking -> Amphetamines
SensationSeeking -> AmylNitrate
SensationSeeking -> Benzos
SensationSeeking -> Caffeine
SensationSeeking -> Cannabis
SensationSeeking -> Chocolate
SensationSeeking -> Cocaine
SensationSeeking -> Crack
SensationSeeking -> Ecstacy
SensationSeeking -> Heroin
SensationSeeking -> Ketamine
SensationSeeking -> LSD
SensationSeeking -> LegalHighs
SensationSeeking -> Meth
SensationSeeking -> Mushrooms
SensationSeeking -> Nicotine
SensationSeeking -> Semeron
SensationSeeking -> VSA
}
')

```
<h2> Plot it</h2>
```{r}
plot(graph)
```
```{r}
#paths(graph, "Agreeableness", "Ecstacy")
#dseparated(graph, "Agreeableness", "Ecstacy")
impliedConditionalIndependencies(graph)
```



```{r}
alpha <- 0.05
results <- localTests(graph, cov_df)

results[results$p.value > alpha, ]

plotLocalTestResults(results)


results[order(results$p.value),]
```

```{r}
paths(graph, "Age", "Ecstacy")
```


```{r}
plot(lm( Ecstacy~Agreeableness,as.data.frame(scale(df)) ) )
```


```{r}
install.packages("lavaan")
library(lavaan)
```

```{r}
dr_df <- cov_df
lvsem <-toString(graph,"lavaan")
lvsem.fit <- sem(lvsem3,cov_df)

summary(lvsem.fit)
```
```{r}
cov_df$Background <-predict(lvsem.fit)


net <-model2network(toString(graph,"bnlearn"))
fit <-bn.fit( net, as.data.frame(cov_df) )

for (drug in drugs)
{
  yhat <- predict(fit, node=drug, data=cov_df,method="bayes-lw")
  print(drug) 
  print(mean((cov_df[[drug]] - yhat)^2)^0.5)
}


#predicted.read <-predict(lvsem.fit,node="Background",data=,method="bayes-lw")
#plot(hsb2[,"read"],predicted.read) 
```

```{r}

summary(ddd)
```






